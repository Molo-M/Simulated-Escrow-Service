declare enum HttpMethod {
    GET = "GET",
    POST = "POST",
    DELETE = "DELETE",
    PATCH = "PATCH",
    PUT = "PUT"
}

interface ApiCall {
    request<T>(method: HttpMethod, endpoint: string, payload?: any): Promise<T>;
}

type Config = {
    host: string;
    accessKey: string;
    headers?: object;
    retryCount?: number;
};
declare class ApiRequest implements ApiCall {
    host: string;
    headers: object;
    accessKey: string;
    retryCount: number;
    constructor(config: Config);
    _init(): void;
    request<T>(method: HttpMethod, endpoint: string, payload?: any): Promise<T>;
    _generateDefaultHeaders(): {
        'user-agent': string;
        'x-api-key': string;
        'api-key': string;
    };
    _isErrorRetryable(error: any): boolean;
}

type ApiKey = {
    key: string;
    name: string;
    customMetaData: AnyJson;
    customAccountId: string;
    customUserId: string;
    env: Environment;
    createdAt: Date;
    updatedAt: Date;
    isActive: boolean;
    rateLimitConfigs: RateLimitConfiguration;
    expiry: Date;
};
type RateLimitConfiguration = {
    rateLimit: number;
    rateLimitTtl: number;
};
type ApiKeyInput = {
    name: string;
    projectId?: string;
    key?: string;
    customMetaData?: AnyJson;
    customAccountId?: string;
    customUserId?: string;
    rateLimitConfigs?: RateLimitConfiguration;
    expiry?: Date;
};
type ApiKeyFilter = {
    projectId?: string;
    name?: string;
    customAccountId?: string | null;
    customUserId?: string | null;
    isActive?: boolean;
};
type UpdateApiKeyInput = {
    name: string;
    key?: string;
    customMetaData?: AnyJson;
    customAccountId?: string;
    customUserId?: string;
    expiry?: Date | null;
    rateLimitConfigs?: RateLimitConfiguration | null;
};
declare enum AuthedEntityType {
    USER = "USER",
    ACCESS_KEY = "ACCESS_KEY"
}
type AuthBaseEntity = {
    isActive: boolean;
    createdBy: string;
    createdByType?: AuthedEntityType;
    createdIn: string;
    lastChangedBy: string;
    lastChangedByType?: AuthedEntityType;
    updatedAt: Date;
    createdAt: Date;
};
type Project = AuthBaseEntity & {
    id: string;
    name: string;
    accountId: string;
    env: Environment;
};
declare enum Environment {
    LIVE = "live",
    TEST = "test"
}
type CreateProjectInput = {
    name: string;
    accountId: string;
    env: Environment;
};
type UpdateProjectInput = {
    name: string;
};
type Account = AuthBaseEntity & {
    id: string;
    name: string;
};
type AnyJson = boolean | number | string | null | JsonArray | JsonMap;
type JsonMap = {
    [key: string]: AnyJson;
};
type JsonArray = Array<AnyJson>;

interface ApiKeysInterface {
    isValidKey(apiKey: string): Promise<boolean>;
    getKey(apiKey: string): Promise<ApiKey>;
    authenticateKey(apiKey: string): Promise<ApiKey>;
    getKeys(filter?: ApiKeyFilter): Promise<ApiKey[]>;
    createKey(apiKey: ApiKeyInput): Promise<ApiKey>;
    updateKey(apiKey: string, updateTo: UpdateApiKeyInput): Promise<ApiKey>;
    deleteKey(apiKey: string): Promise<boolean>;
    reactivateKey(apiKey: string): Promise<ApiKey>;
    rotateKey(apiKey: string): Promise<ApiKey>;
}

declare class ApiKeys implements ApiKeysInterface {
    api: ApiRequest;
    private readonly endpoint;
    constructor(apiService: ApiRequest);
    isValidKey(apikey: string): Promise<boolean>;
    authenticateKey(apikey: string): Promise<ApiKey>;
    getKeys(filter?: ApiKeyFilter): Promise<ApiKey[]>;
    getKey(apikey: string): Promise<ApiKey>;
    createKey(apiKey: ApiKeyInput): Promise<ApiKey>;
    updateKey(apiKey: string, updatedKey: UpdateApiKeyInput): Promise<ApiKey>;
    deleteKey(apiKey: string): Promise<boolean>;
    reactivateKey(apiKey: string): Promise<ApiKey>;
    rotateKey(apiKey: string): Promise<ApiKey>;
    private getKeysFilterEndpoint;
}

interface ProjectsInterface {
    getProjects(accountId: string): Promise<Project[]>;
    getProject(projectId: string): Promise<Project>;
    deleteProject(projectId: string): Promise<boolean>;
    createProject(project: CreateProjectInput): Promise<Project>;
    updateProject(name: string, updateTo: UpdateProjectInput): Promise<Project>;
}

declare class Projects implements ProjectsInterface {
    api: ApiRequest;
    endpoint: string;
    constructor(apiService: ApiRequest);
    getProjects(accountId: string): Promise<Project[]>;
    getProject(projectId: string): Promise<Project>;
    deleteProject(projectId: string): Promise<boolean>;
    createProject(project: CreateProjectInput): Promise<Project>;
    updateProject(projectId: string, project: UpdateProjectInput): Promise<Project>;
}

interface AccountsInterface {
    getAccount(accountId: string): Promise<Account>;
}

declare class Accounts implements AccountsInterface {
    api: ApiRequest;
    endpoint: string;
    constructor(apiService: ApiRequest);
    getAccount(accountId: string): Promise<Account>;
}

type Options = {
    host?: string;
    retryCount?: number;
};
declare class TheAuthAPI {
    accessKey: string;
    host: string;
    timeout: number | string | undefined;
    api: ApiRequest;
    apiKeys: ApiKeys;
    projects: Projects;
    accounts: Accounts;
    /**
     * @param {String} accessKey
     * @param {Object} [options] (optional)
     *   @property {String} host (default: 'https://api.segment.io')
     *   @property {number} retryCount (default: 3)
     */
    constructor(accessKey: string, options?: Options);
    authenticateAPIKey(key: string, callback?: (err: any, data: any) => any): Promise<unknown>;
}

export { TheAuthAPI as default };
